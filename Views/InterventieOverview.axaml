<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="Elumatec.Tijdregistratie.Views.InterventieOverview">

    <Grid RowDefinitions="Auto,*" Margin="10">

        <Grid ColumnDefinitions="Auto,Auto,*,Auto,Auto"
              Grid.Row="0"
              VerticalAlignment="Top"
              ColumnSpacing="10">

            <!-- New interventie button with pink background and border-only on hover -->
            <Button Content="Nieuwe interventie"
                    FontSize="18"
                    Padding="20,12"
                    Command="{Binding NieuweInterventieCommand}">
                <Button.Styles>
                    <Style Selector="Button">
                        <Setter Property="Background" Value="#ff0092"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="BorderBrush" Value="#ff0092"/>
                        <Setter Property="BorderThickness" Value="3"/>
                        <Setter Property="CornerRadius" Value="4"/>
                    </Style>
                    <Style Selector="Button:pointerover /template/ ContentPresenter">
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="BorderBrush" Value="#ff0092"/>
                        <Setter Property="BorderThickness" Value="3"/>
                    </Style>
                    <Style Selector="Button:pointerover">
                        <Setter Property="Foreground" Value="#ff0092"/>
                    </Style>
                </Button.Styles>
            </Button>

            <!-- Filter label + dropdown -->
            <StackPanel Grid.Column="1" Orientation="Vertical" Spacing="2">
                <TextBlock Text="Filter" FontSize="12" Opacity="0.7" />
                <ComboBox Width="160"
                          ItemsSource="{Binding FilterTypes}"
                          SelectedItem="{Binding SelectedFilter}" />
            </StackPanel>

            <!-- Text search -->
            <TextBox Grid.Column="2"
                     Watermark="Zoeken..."
                     Text="{Binding SearchText, Mode=TwoWay}"
                     IsVisible="{Binding IsTextSearch}" />

            <!-- Date search: vertical stack with From/To labels -->
            <StackPanel Grid.Column="2"
                        Orientation="Vertical"
                        Spacing="4"
                        IsVisible="{Binding IsDateSearch}">

                <StackPanel Orientation="Horizontal" Spacing="4">
                    <TextBlock VerticalAlignment="Center" Text="Van:" />
                    <DatePicker SelectedDate="{Binding FromDate}" />
                </StackPanel>

                <StackPanel Orientation="Horizontal" Spacing="4">
                    <TextBlock VerticalAlignment="Center" Text="Tot: " />
                    <DatePicker SelectedDate="{Binding ToDate}" />
                </StackPanel>

            </StackPanel>

            <!-- User button -->
            <StackPanel Grid.Column="4" Orientation="Vertical" Spacing="6">
                <Button Command="{Binding TerugCommand}"
                        Background="#F0F0F0"
                        BorderBrush="Gray"
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="6"
                        HorizontalAlignment="Center">
                    <TextBlock FontWeight="SemiBold"
                               Text="{Binding GebruikerNaam, StringFormat=Gebruiker: {0}}" />
                </Button>
            </StackPanel>
        </Grid>

        <ScrollViewer Grid.Row="1"
                      Margin="0,20,0,0"
                      VerticalScrollBarVisibility="Auto">

            <ItemsControl ItemsSource="{Binding Interventies}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>

                        <!-- Outer border around each interventie -->
                        <Border Margin="0,0,0,12"
                                Padding="14"
                                CornerRadius="6"
                                BorderThickness="1"
                                BorderBrush="Gray"
                                MinWidth="900">
                            
                            <Button Background="Transparent"
                                    BorderThickness="0"
                                    HorizontalContentAlignment="Stretch"
                                    MinWidth="900" 
                                    Height="120"
                                    Command="{Binding DataContext.OpenInterventieCommand,
                                                      RelativeSource={RelativeSource AncestorType=UserControl}}"
                                    CommandParameter="{Binding}">
                                
                                <Grid ColumnDefinitions="2*,3*" ColumnSpacing="20">
                                    <!-- LEFT: main info -->
                                    <StackPanel Grid.Column="0" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding Machine}" FontSize="20" FontWeight="Bold"/>
                                        <TextBlock Text="{Binding Bedrijfsnaam}" Opacity="0.7" Margin="0,2,0,6"/>
                                        <TextBlock Text="{Binding DatumRecentsteCall, StringFormat='Laatste call: {0:dd-MM-yyyy HH:mm}'}" FontSize="12" Opacity="0.6"/>
                                        <TextBlock Text="{Binding AantalCalls, StringFormat='Aantal calls: {0}'}" FontSize="12" Opacity="0.6"/>
                                    </StackPanel>

                                    <!-- RIGHT: notes -->
                                    <StackPanel Grid.Column="1" Spacing="8" MinWidth="400" VerticalAlignment="Center">
                                        <StackPanel>
                                            <TextBlock Text="Interne notities" FontWeight="SemiBold" FontSize="13"/>
                                            <TextBlock Text="{Binding InterneNotitiesKort}" TextWrapping="Wrap" Opacity="0.8" MaxHeight="50"/>
                                        </StackPanel>
                                        <StackPanel>
                                            <TextBlock Text="Externe notities" FontWeight="SemiBold" FontSize="13"/>
                                            <TextBlock Text="{Binding ExterneNotitiesKort}" TextWrapping="Wrap" Opacity="0.8" MaxHeight="50"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </Button>
                            <!-- End of clickable interventie -->
                        </Border>

                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>

        </ScrollViewer>

    </Grid>
</UserControl>
